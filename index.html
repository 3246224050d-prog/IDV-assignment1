<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Singapore PSI Air Quality</title>

<style>
/* ===== UI Styles ===== */

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
  background:linear-gradient(135deg,#dbeafe,#f1f5f9);
  color:#0f172a;
}

.page{max-width:900px;margin:40px auto;padding:0 16px;}

.header{text-align:center;margin-bottom:24px;}
.header h1{margin:0 0 8px;font-size:28px;}
.subtitle{margin:0;font-size:14px;color:#64748b;}

.controls{
  display:flex;justify-content:space-between;align-items:center;
  gap:10px;margin-bottom:20px;flex-wrap:wrap;
}

#region-select{
  padding:6px 10px;border-radius:6px;border:1px solid #cbd5f5;background:#fff;
  font-size:14px;box-shadow:0 1px 2px rgba(0,0,0,.08);
}

.timestamp{font-size:12px;color:#64748b;}

.card{
  background:#fff;border-radius:12px;padding:18px;
  box-shadow:0 10px 28px rgba(0,0,0,.12);
}

table{width:100%;border-collapse:collapse;}
thead{background:#eff6ff;}

th,td{
  padding:10px 12px;border-bottom:1px solid #e2e8f0;font-size:14px;
}
tbody tr:nth-child(even){background:#f8fafc;}
th{font-weight:600;color:#1e293b;}

.error{
  margin-top:10px;padding:8px 10px;border-radius:8px;
  background:#fee2e2;color:#991b1b;font-size:13px;display:none;
}
</style>
</head>


<body>
<div class="page">

  <header class="header">
    <h1>Singapore PSI Air Quality</h1>
    <p class="subtitle">Live data from API: data.gov.sg</p>
  </header>

  <section class="controls">
    <div>
      <label><b>Region:</b> </label>
      <select id="region-select">
        <option value="north">North</option>
        <option value="south">South</option>
        <option value="east">East</option>
        <option value="west">West</option>
        <option value="central">Central</option>
      </select>
    </div>
    <span id="timestamp" class="timestamp"></span>
  </section>

  <section class="card">
    <table id="psi-table">
      <thead>
        <tr><th>Air Quality Reading</th><th>Value</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <div id="error-msg" class="error">Failed to load data.</div>
  </section>
</div>


<script>
/* ========= JS Fetch + English Reading Names ========= */

const API="https://api.data.gov.sg/v1/environment/psi";
const tableBody=document.querySelector("#psi-table tbody");
const regionSelect=document.querySelector("#region-select");
const timestamp=document.querySelector("#timestamp");
const errorBox=document.querySelector("#error-msg");

let readings=null;

/* ðŸ”¥ English-friendly labels */
const labels={
  pm25_sub_index:"PM2.5 Index",
  pm25_twenty_four_hourly:"PM2.5 (24h Avg)",
  pm10_sub_index:"PM10 Index",
  pm10_twenty_four_hourly:"PM10 (24h Avg)",
  o3_sub_index:"Ozone (Oâ‚ƒ) Index",
  o3_eight_hour_max:"Ozone (Oâ‚ƒ) â€“ 8hr Max",
  co_sub_index:"Carbon Monoxide (CO) Index",
  co_eight_hour_max:"Carbon Monoxide (CO) â€“ 8hr Max",
  so2_sub_index:"Sulfur Dioxide (SOâ‚‚) Index",
  so2_twenty_four_hourly:"Sulfur Dioxide (SOâ‚‚) â€“ 24h Avg",
  no2_one_hour_max:"Nitrogen Dioxide (NOâ‚‚) â€“ 1hr Max",
  psi_twenty_four_hourly:"PSI â€“ 24h General Index"
};


/* Fetch PSI values */
fetch(API)
.then(r=>r.json())
.then(data=>{
  readings=data.items[0].readings;
  timestamp.textContent="Updated: "+data.items[0].timestamp;
  render(regionSelect.value);
})
.catch(()=>errorBox.style.display="block");


regionSelect.addEventListener("change",()=>render(regionSelect.value));


/* Render selected region only (no national) */
function render(region){
  tableBody.innerHTML="";
  for(const [key,val] of Object.entries(readings)){
    let row=document.createElement("tr");
    let name=labels[key] || key.replace(/_/g," ").toUpperCase();
    row.innerHTML=`<td>${name}</td><td>${val[region] ?? "N/A"}</td>`;
    tableBody.appendChild(row);
  }
}
</script>

</body>
</html>
