import json

def print_table(headers, data):
    """
    打印表格的简单实现
    """
    # 计算每列的最大宽度
    col_widths = []
    for i in range(len(headers)):
        max_width = len(str(headers[i]))
        for row in data:
            if i < len(row):
                max_width = max(max_width, len(str(row[i])))
        col_widths.append(max_width + 2)  # 加2为了留出空格
    
    # 打印表头
    header_line = ""
    for i, header in enumerate(headers):
        header_line += str(header).ljust(col_widths[i])
    print(header_line)
    print("-" * len(header_line))
    
    # 打印数据行
    for row in data:
        row_line = ""
        for i, cell in enumerate(row):
            row_line += str(cell).ljust(col_widths[i])
        print(row_line)

def main():
    """
    主函数 - 处理PSI数据并打印表格
    """
    # 你的JSON数据
    data = {
        "code": 0,
        "data": {
            "regionMetadata": [
                {"name": "west", "labelLocation": {"latitude": 1.35735, "longitude": 103.7}},
                {"name": "east", "labelLocation": {"latitude": 1.35735, "longitude": 103.94}},
                {"name": "central", "labelLocation": {"latitude": 1.35735, "longitude": 103.82}},
                {"name": "south", "labelLocation": {"latitude": 1.29587, "longitude": 103.82}},
                {"name": "north", "labelLocation": {"latitude": 1.41803, "longitude": 103.82}}
            ],
            "items": [
                {
                    "date": "2025-10-06",
                    "updatedTimestamp": "2025-10-06T20:31:03+08:00",
                    "timestamp": "2025-10-06T20:00:00+08:00",
                    "readings": {
                        "o3_sub_index": {"west": 3, "east": 14, "central": 7, "south": 7, "north": 9},
                        "no2_one_hour_max": {"west": 46, "east": 40, "central": 41, "south": 36, "north": 30},
                        "o3_eight_hour_max": {"west": 6, "east": 32, "central": 17, "south": 16, "north": 21},
                        "psi_twenty_four_hourly": {"west": 58, "east": 59, "central": 62, "south": 53, "north": 56},
                        "pm10_twenty_four_hourly": {"west": 27, "east": 33, "central": 32, "south": 26, "north": 23},
                        "pm10_sub_index": {"west": 27, "east": 33, "central": 32, "south": 26, "north": 23},
                        "pm25_twenty_four_hourly": {"west": 18, "east": 19, "central": 22, "south": 14, "north": 16},
                        "so2_sub_index": {"west": 3, "east": 2, "central": 4, "south": 2, "north": 7},
                        "pm25_sub_index": {"west": 58, "east": 59, "central": 62, "south": 53, "north": 56},
                        "so2_twenty_four_hourly": {"west": 5, "east": 4, "central": 6, "south": 3, "north": 11},
                        "co_eight_hour_max": {"west": 0, "east": 0, "central": 0, "south": 0, "north": 0},
                        "co_sub_index": {"west": 3, "east": 4, "central": 2, "south": 4, "north": 4}
                    }
                }
            ]
        },
        "errorMsg": ""
    }

    # 获取读数数据
    readings = data['data']['items'][0]['readings']
    
    # 定义要显示的所有读数类型（按照题目要求的顺序）
    reading_types = [
        'o3_sub_index',
        'o3_eight_hour_max', 
        'co_sub_index',
        'co_eight_hour_max',
        'pm10_sub_index',
        'pm10_twenty_four_hourly',
        'so2_sub_index',
        'so2_twenty_four_hourly',
        'no2_one_hour_max',
        'pm25_sub_index',
        'pm25_twenty_four_hourly',
        'psi_twenty_four_hourly'
    ]
    
    # 定义区域（从regionMetadata中获取）
    regions = [region['name'] for region in data['data']['regionMetadata']]
    
    # 准备表格数据
    table_data = []
    
    for reading_type in reading_types:
        if reading_type in readings:
            row = [reading_type.replace('_', ' ').title()]
            for region in regions:
                if region in readings[reading_type]:
                    row.append(readings[reading_type][region])
                else:
                    row.append('N/A')
            table_data.append(row)
    
    # 表格标题
    headers = ['Reading Type'] + [region.title() for region in regions]
    
    print("\n" + "="*80)
    print("PSI READINGS DATA")
    print("="*80)
    print_table(headers, table_data)
    
    # 显示更新时间
    timestamp = data['data']['items'][0].get('timestamp', '')
    print(f"\n数据更新时间: {timestamp}")

if __name__ == "__main__":
    main()
